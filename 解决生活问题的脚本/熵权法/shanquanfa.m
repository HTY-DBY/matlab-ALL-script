% 渡边笔记 熵权法
clc;clear;close all;
% 熵权法的思想是：变量数值变化越大，变异程度越大，则其权重应该更大；反之权重则越小
 x = [
2.41	52.59	0	9.78	1.17
1.42	53.21	0	6.31	1.63
4.71	35.16	1	9.17	3.02
14.69	15.16	2.13	10.35	7.97
0.94	72.99	0	7.39	0.61
1.43	72.62	0	8.16	0.51
2.21	67.5	0	9.84	0.85
3.79	51.21	0	12.95	1.43
1.23	85.09	3.97	4.08	0.13
1.71	82.07	2.88	4.97	0.33
3.63	66.9	3.18	8.57	0.71
5.72	49.77	3.44	10.52	1.83
1.49	79.51	6.53	2.58	0.27
1.66	81.44	5.18	2.74	0.36
2.41	76.32	5.88	4.13	0.54
4.42	59.65	7.64	8.38	1.02
3.27	88.42	3.36	2.85	0.14
11.27	70.05	5.77	6.07	0.19
13.18	62.45	5.66	7.85	0.74
15.83	56.28	2.92	9.97	1.14
11.59	80.23	1.04	3.64	0.2
26.67	55.7	2.02	8.13	0.38
28.51	51.07	2.12	9.66	1.46
3.69	87.26	0	3.12	0.18
3.27	84.43	0	5.43	0.31
3.98	79.99	0	6.62	0.57
1.59	86.5	0	6.14	0.14
4.31	82.26	0	4.71	0.2
4.6	72.79	0	8.27	0.52
4.99	81.93	0	7.52	0.16
4.66	75.09	0	10.24	0.33
5.08	61.02	1.57	15.7	0.53
12.49	83.06	0	1.2	1.06
4.67	92.77	0	0.33	0.58
5.8	90.32	0	0.91	0.8
97.76	0	0	0	2.14
94.75	0	0	1.42	2.83
93.76	0	0	1.18	3.24
3.48	81.43	7.45	1.33	0.14
4.2	80	5.3	2.21	0.18
8.83	71.28	5.34	2.9	0.43
5.39	79.6	6.87	2.64	0.31
7.67	74.74	5.91	3.4	0.66
19.65	55.4	4.87	6.14	1.2
2.63	90.74	3.18	1.42	0.14
2.8	89.7	2.85	1.96	0.14
4.07	85.12	3.43	3.52	0.25
5.7	83.4	0	4.48	0.1
4.03	81.35	0	6.18	0.19
4.11	73.45	0	9.71	0.45
2.78	89.53	0	4.23	0.2
3.92	83.2	0	7.59	0.32
5.21	71.37	3.09	10.29	0.72
18.98	76.81	0	1.05	0.31
19.79	73.56	0	0.88	0.42
19.86	70.07	0	1.72	0.74
16.61	67.57	3.77	3.15	1.16
6.91	82.18	4.19	0	0.1
2.93	83.06	1.93	5.14	0.32
8.47	78.11	4.04	4.02	0.31
12.29	70.48	3.89	4.32	0.69
3.98	84.81	4.76	1.97	0.18
7.67	78.13	4.22	4.57	0.35
14.04	66.89	4.41	6.27	0.47
14.62	59.29	5.28	8.35	0.77
1.97	85.16	4.87	3.27	0.23
2.16	86.83	3.82	2.25	0.15
4.81	74.9	5.05	5.97	0.5
7.44	57.98	6.75	10.73	1.04
2.04	86.01	4.79	2.95	0.13
3.49	79.79	5.67	4.28	0.15
6.47	68.02	6.71	5.74	0.2
7.94	59.12	7.14	5.93	1.42



];

[m,n]=size(x);
lamda=ones(1,n); % 人为修权，1代表不修改计算后的指标权重
for i=1:n
    x(:,i)=(x(:,i)-min(x(:,i)))/(max(x(:,i))-min(x(:,i)))+1; % 对原始数据进行非负数化、归一化处理，值介于1-2之间
end
for i=1:m
    for j=1:n
        p(i,j)=x(i,j)/sum(x(:,j));
    end
end
k=1/log(m);
for i=1:m
    for j=1:n
        if p(i,j)~=0
            e(i,j)=p(i,j)*log(p(i,j));
        else
            e(i,j)=0;
        end
    end
end
for j=1:n
    E(j)=-k*sum(e(:,j));
end
d=1-E;
for j=1:n
    w(j)=d(j)/sum(d);% 指标权重计算
end
for j=1:n
    w(j)=w(j)*lamda(j)/sum(w.*lamda);% 修改指标权重
end
for i=1:m
    score(i,1)=sum(x(i,:).*w);% 计算综合分数
end
disp('各指标权重为：')
disp(w)
disp('各项综合分数为：')
disp(score)
Out = mean (score,1)